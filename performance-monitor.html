<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Monitor - Vedang Portfolio</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        .metric-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .metric-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-good { background: #e8f5e8; color: #2e7d32; }
        .status-fair { background: #fff3e0; color: #f57c00; }
        .status-poor { background: #ffebee; color: #d32f2f; }
        .recommendations {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .recommendations h3 {
            color: #333;
            margin-top: 0;
        }
        .recommendation {
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
            background: #f8f9ff;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        .test-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #5a6fd8;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Vedang Portfolio Performance Monitor</h1>
        <p>Real-time performance metrics and optimization recommendations</p>
    </div>

    <div class="test-controls">
        <h3>Performance Tests</h3>
        <button class="btn" onclick="runPerformanceTest()">üöÄ Run Performance Test</button>
        <button class="btn" onclick="testImageLoading()">üñºÔ∏è Test Image Loading</button>
        <button class="btn" onclick="testServiceWorker()">‚öôÔ∏è Test Service Worker</button>
        <button class="btn" onclick="window.open('https://pagespeed.web.dev/', '_blank')">üîç PageSpeed Insights</button>
    </div>

    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-title">Page Load Time</div>
            <div class="metric-value" id="loadTime">Measuring...</div>
            <div class="metric-status" id="loadTimeStatus">Analyzing</div>
        </div>

        <div class="metric-card">
            <div class="metric-title">First Contentful Paint</div>
            <div class="metric-value" id="fcp">Measuring...</div>
            <div class="metric-status" id="fcpStatus">Analyzing</div>
        </div>

        <div class="metric-card">
            <div class="metric-title">Largest Contentful Paint</div>
            <div class="metric-value" id="lcp">Measuring...</div>
            <div class="metric-status" id="lcpStatus">Analyzing</div>
        </div>

        <div class="metric-card">
            <div class="metric-title">Service Worker</div>
            <div class="metric-value" id="sw">Checking...</div>
            <div class="metric-status" id="swStatus">Analyzing</div>
        </div>

        <div class="metric-card">
            <div class="metric-title">Images Loaded</div>
            <div class="metric-value" id="images">Counting...</div>
            <div class="metric-status" id="imagesStatus">Analyzing</div>
        </div>

        <div class="metric-card">
            <div class="metric-title">Memory Usage</div>
            <div class="metric-value" id="memory">Measuring...</div>
            <div class="metric-status" id="memoryStatus">Analyzing</div>
        </div>
    </div>

    <div class="recommendations">
        <h3>üéØ Performance Recommendations</h3>
        <div id="recommendations">
            <div class="loading">Analyzing performance...</div>
        </div>
    </div>

    <script>
        class PerformanceMonitor {
            constructor() {
                this.metrics = {
                    loadTime: 0,
                    fcp: 0,
                    lcp: 0,
                    images: 0,
                    memory: 0
                };
                this.init();
            }

            init() {
                this.measurePageLoad();
                this.measurePaintMetrics();
                this.checkServiceWorker();
                this.countImages();
                this.measureMemory();
                this.generateRecommendations();
            }

            measurePageLoad() {
                window.addEventListener('load', () => {
                    const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                    this.metrics.loadTime = loadTime;
                    
                    document.getElementById('loadTime').textContent = `${loadTime}ms`;
                    
                    const status = loadTime < 2000 ? 'good' : loadTime < 4000 ? 'fair' : 'poor';
                    const statusText = loadTime < 2000 ? 'Excellent' : loadTime < 4000 ? 'Good' : 'Needs Improvement';
                    
                    document.getElementById('loadTimeStatus').textContent = statusText;
                    document.getElementById('loadTimeStatus').className = `metric-status status-${status}`;
                });
            }

            measurePaintMetrics() {
                if ('PerformanceObserver' in window) {
                    const observer = new PerformanceObserver((list) => {
                        for (const entry of list.getEntries()) {
                            if (entry.name === 'first-contentful-paint') {
                                this.metrics.fcp = entry.startTime;
                                document.getElementById('fcp').textContent = `${Math.round(entry.startTime)}ms`;
                                
                                const status = entry.startTime < 1800 ? 'good' : entry.startTime < 3000 ? 'fair' : 'poor';
                                const statusText = entry.startTime < 1800 ? 'Excellent' : entry.startTime < 3000 ? 'Good' : 'Slow';
                                
                                document.getElementById('fcpStatus').textContent = statusText;
                                document.getElementById('fcpStatus').className = `metric-status status-${status}`;
                            }
                            
                            if (entry.entryType === 'largest-contentful-paint') {
                                this.metrics.lcp = entry.startTime;
                                document.getElementById('lcp').textContent = `${Math.round(entry.startTime)}ms`;
                                
                                const status = entry.startTime < 2500 ? 'good' : entry.startTime < 4000 ? 'fair' : 'poor';
                                const statusText = entry.startTime < 2500 ? 'Excellent' : entry.startTime < 4000 ? 'Good' : 'Slow';
                                
                                document.getElementById('lcpStatus').textContent = statusText;
                                document.getElementById('lcpStatus').className = `metric-status status-${status}`;
                            }
                        }
                    });
                    
                    observer.observe({entryTypes: ['paint', 'largest-contentful-paint']});
                }
            }

            checkServiceWorker() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then((registrations) => {
                        const isActive = registrations.length > 0;
                        
                        document.getElementById('sw').textContent = isActive ? 'Active' : 'Inactive';
                        document.getElementById('swStatus').textContent = isActive ? 'Working' : 'Not Found';
                        document.getElementById('swStatus').className = `metric-status status-${isActive ? 'good' : 'poor'}`;
                    });
                } else {
                    document.getElementById('sw').textContent = 'Not Supported';
                    document.getElementById('swStatus').textContent = 'Browser Issue';
                    document.getElementById('swStatus').className = 'metric-status status-poor';
                }
            }

            countImages() {
                const images = document.querySelectorAll('img');
                const totalImages = images.length;
                let loadedImages = 0;

                images.forEach(img => {
                    if (img.complete) {
                        loadedImages++;
                    } else {
                        img.addEventListener('load', () => {
                            loadedImages++;
                            this.updateImageCount(loadedImages, totalImages);
                        });
                    }
                });

                this.updateImageCount(loadedImages, totalImages);
            }

            updateImageCount(loaded, total) {
                document.getElementById('images').textContent = `${loaded}/${total}`;
                
                const percentage = (loaded / total) * 100;
                const status = percentage === 100 ? 'good' : percentage > 80 ? 'fair' : 'poor';
                const statusText = percentage === 100 ? 'All Loaded' : percentage > 80 ? 'Loading' : 'Issues';
                
                document.getElementById('imagesStatus').textContent = statusText;
                document.getElementById('imagesStatus').className = `metric-status status-${status}`;
            }

            measureMemory() {
                if (performance.memory) {
                    const memory = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                    this.metrics.memory = memory;
                    
                    document.getElementById('memory').textContent = `${memory} MB`;
                    
                    const status = memory < 30 ? 'good' : memory < 50 ? 'fair' : 'poor';
                    const statusText = memory < 30 ? 'Optimal' : memory < 50 ? 'Moderate' : 'High';
                    
                    document.getElementById('memoryStatus').textContent = statusText;
                    document.getElementById('memoryStatus').className = `metric-status status-${status}`;
                } else {
                    document.getElementById('memory').textContent = 'N/A';
                    document.getElementById('memoryStatus').textContent = 'Unavailable';
                    document.getElementById('memoryStatus').className = 'metric-status status-fair';
                }
            }

            generateRecommendations() {
                setTimeout(() => {
                    const recommendations = [];
                    
                    if (this.metrics.loadTime > 3000) {
                        recommendations.push('‚ö° Page load time is slow. Consider optimizing images and reducing JavaScript bundle size.');
                    }
                    
                    if (this.metrics.fcp > 2000) {
                        recommendations.push('üé® First Contentful Paint is slow. Optimize critical rendering path and consider inlining critical CSS.');
                    }
                    
                    if (this.metrics.lcp > 3000) {
                        recommendations.push('üñºÔ∏è Largest Contentful Paint is slow. Optimize hero images and preload critical resources.');
                    }
                    
                    if (this.metrics.memory > 40) {
                        recommendations.push('üíæ Memory usage is high. Consider implementing lazy loading and cleaning up unused resources.');
                    }
                    
                    if (recommendations.length === 0) {
                        recommendations.push('üéâ Excellent performance! Your website is well optimized.');
                    }
                    
                    const recommendationsHtml = recommendations.map(rec => 
                        `<div class="recommendation">${rec}</div>`
                    ).join('');
                    
                    document.getElementById('recommendations').innerHTML = recommendationsHtml;
                }, 3000);
            }
        }

        // Test functions
        function runPerformanceTest() {
            location.reload();
        }

        function testImageLoading() {
            const images = document.querySelectorAll('img');
            console.log(`Testing ${images.length} images...`);
            
            images.forEach((img, index) => {
                const startTime = performance.now();
                
                img.addEventListener('load', () => {
                    const loadTime = performance.now() - startTime;
                    console.log(`Image ${index + 1} loaded in ${Math.round(loadTime)}ms`);
                });
            });
        }

        function testServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then((registrations) => {
                    console.log('Service Worker registrations:', registrations);
                    
                    registrations.forEach((registration, index) => {
                        console.log(`SW ${index + 1}:`, {
                            scope: registration.scope,
                            state: registration.active?.state,
                            updateViaCache: registration.updateViaCache
                        });
                    });
                });
            }
        }

        // Initialize performance monitoring
        document.addEventListener('DOMContentLoaded', () => {
            new PerformanceMonitor();
        });
    </script>
</body>
</html>
